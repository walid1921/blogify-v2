{% extends 'base.html.twig' %}



{% block title %}Update Blogs{% endblock %}


{% block body %}

    <div class="notification-container">
        {% for label, messages in app.flashes %}
            {% for message in messages %}
                {% include 'components/_toast.html.twig' with { type: label,  message: message } %}
            {% endfor %}
        {% endfor %}
    </div>


    <div class="page-container">

        <div class="d-flex align-items-end justify-content-between mb-3 px-4">

            <div class="d-flex flex-column gap-1 mb-4 ">
                <div class="d-flex align-items-start gap-2">
                    <h1 class="text-uppercase fs-2">UPDATE BLOGS</h1>
                    <span>({{ blogs|length }})</span>
                </div>
                <p class="fw-light">Subtitle: Write something here</p>
            </div>


            {% include 'components/_button.html.twig' with {
                typeButton: 'primary',
                path: path('blog.create'),
                iconType: 'add',
                iconColor: 'white',
                textButton: 'New blog',
            } %}
        </div>

        <div class="px-4">
            <div class="table-responsive border border-black border-opacity-25 ">
                <table class="table table-striped table-hover">
                    <caption>List of blogs</caption>
                    <thead class="table-light">
                    <tr>
                        <th scope="col" class="ps-3 py-3">#</th>
                        <th scope="col" class="py-3">Title</th>
                        <th scope="col" class="py-3">Content</th>
                        <th scope="col" class="py-3">
                            <a
                                href="{{ path('blog.blogsTable', { order: order == 'ASC' ? 'DESC' : 'ASC' }) }}">
                                Created
                                {% if order == 'ASC' %}
                                    <img src="{{ asset('icons/Sort From Bottom To Top.svg') }}" alt="sort icon">
                                {% else %}
                                    <img src="{{ asset('icons/Sort From Top To Bottom.svg') }}" alt="sort icon">
                                {% endif %}
                            </a>
                        </th>

                        <th scope="col" class="py-3">Status</th>
                        <th scope="col" class="pe-3 py-3">Update</th>
                    </tr>
                    </thead>
                    <tbody>
                    {# {{ dump(blogs) }} #}
                    {% for key,blog in blogs %}
                        <tr>
                            <td class="text-secondary ps-3 py-3">{{ blog.id }}</td>
                            <td class="py-3">
                                <a href="#"
                                   class="link-no-underline-black d-inline-block align-items-center ">
                                    <img class="me-2" src="{{ asset('icons/Link Square.svg') }}" alt="pen icon">
                                    {{ blog.title|u.truncate(30, '...') }}
                                </a>
                            </td>
                            <td class="py-3">{{ blog.content|u.truncate(70, '...') }}</td>
                            <td class="py-3">{{ blog.createdAt|date('Y-m-d') }}</td>
                            <td class="py-3">
                                {% if (blog.published) %}
                                    <span class="text-success">Published</span>
                                {% else %}
                                    <span class="text-danger">Pending</span>
                                {% endif %}
                            </td>
                            <td class="py-3">
                                <a class="me-3"
                                   href="#"
                                   data-bs-toggle="modal"
                                   data-bs-target="#deleteModal-{{ blog.id }}">
                                    <img
                                        data-bs-toggle="tooltip"
                                        data-bs-placement="top"
                                        data-bs-title="Delete"
                                        src="{{ asset('icons/Trash Bin Trash.svg') }}"
                                        alt="pen icon">
                                </a>
                                <a href="{{ path('blog.edit', {id: blog.id} ) }}" data-bs-toggle="tooltip"
                                   data-bs-placement="top"
                                   data-bs-title="Edit">
                                    <img src="{{ asset('icons/Pen New Square.svg') }}" alt="pen icon">
                                </a>
                            </td>
                        </tr>

                        {% include "components/_modalConfirm.html.twig" with {
                            modal_id: "deleteModal-" ~ blog.id,
                            title: "Confirm Deletion",
                            body: "Are you sure you want to delete <strong>" ~ blog.title ~ "</strong>?",
                            confirm_path: path('blog.delete', {id: blog.id}),
                            confirm_text: "Delete"
                        } %}

                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

{% endblock %}
