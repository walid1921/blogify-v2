{% extends 'base.html.twig' %}

{% block title %}Login{% endblock %}

{% block body %}
    {# Notifications #}
    <div class="notification-container">
        {% for label, messages in app.flashes %}
            {% for message in messages %}
                {% include 'components/_toast.html.twig' with { type: label,  message: message } %}
            {% endfor %}
        {% endfor %}
    </div>

    <div class="page-container mt-4 mb-5">


        <form action="{{ path('app_login') }}"
              method="post"
              class="d-flex flex-column justify-content-center align-items-center">

            {# --- Switcher (Login / Register) --- #}
            {% include 'components/_auth_switcher.html.twig' %}

            {# --- Login Form --- #}
            <div class="w-25 d-flex flex-column form-wrapper mt-3">

                {# --- Error Message --- #}
                {% if error %}
                    <div class="alert alert-danger" data-test="invalid-message">
                        {{ error.messageKey|trans(error.messageData, 'security') }}
                    </div>
                {% endif %}

                {# ======================== GOOGLE LOGIN BUTTON ======================== #}
                <a href="{{ path('connect_google') }}" class="google-btn mb-4">
                    <img src="{{ asset('icons/google.svg') }}" class="google-icon" alt="Google">
                    Login with Google
                </a>

                {# ======================== DIVIDER ======================== #}
                <div class="divider my-4">
                    <span>or continue with email</span>
                </div>

                {# ======================== EMAIL FIELD ======================== #}
                <div class="my-custom-row mt-4">
                    <div class="input-wrapper">
                        <input type="text"
                               id="username"
                               name="_username"
                               class="my-input"
                               value="{{ lastUsername }}"
                               required
                               autofocus>
                        <label for="username" class="my-label">Email</label>
                        <span class="underline"></span>
                    </div>
                </div>

                {# ======================== PASSWORD FIELD ======================== #}
                <div class="my-custom-row mt-4">
                    <div class="input-wrapper">
                        <input type="password"
                               id="password"
                               name="_password"
                               class="my-input"
                               required>
                        <label for="password" class="my-label">Password</label>
                        <span class="underline"></span>
                    </div>
                </div>

                {# --- Forgot Password link --- #}
                <div class="d-flex align-items-center gap-2 mt-2">
                    <p class="text-secondary fs-8"> Forgot your password?</p>
                    <a href="{{ path('dashboard.allBlogs') }}"
                       class="link-underline-black fs-8">
                        Reset password
                    </a>
                </div>


                <input type="hidden" name="_csrf_token" data-controller="csrf-protection"
                       value="{{ csrf_token('authenticate') }}">

                {# --- Redirect path after login --- #}
                <input type="hidden" name="_target_path" value="{{ path('dashboard.home') }}">

                {# ======================== SUBMIT BUTTON ======================== #}
                <button type="submit" class="button-primary mt-5 py-2 px-4">
                    Login
                </button>

                {# ======================== ADVANTAGES SECTION ======================== #}
                <div class="login-advantages mt-5">
                    <h6>Login advantages:</h6>
                    <ul>
                        <li>Save & manage your favorite blogs</li>
                        <li>Read all blogs for free</li>
                        <li>Get notified when new blogs are published</li>
                        <li>Interact with the blogging community</li>
                    </ul>
                </div>
            </div>
        </form>
    </div>

{% endblock %}

{% block footer %}
    <footer>
        {{ include('components/_footer.html.twig') }}
    </footer>
{% endblock %}
