{% include 'components/_section_header.html.twig' with {
    title: 'BLOGS',
    count: blogs|length,
    description: 'Update and delete blogs here',
    buttonType: 'primary',
    buttonPath: path('blog.create'),
    buttonText: 'New Blog',
    buttonIconType: 'add',
    buttonIconColor: 'white'
} %}


<div class="table-responsive border border-black border-opacity-25 ">
    <table class="table table-striped table-hover">
        <thead class="table-light">
        <tr>
            <th scope="col" class="ps-3 py-3 2-25">#</th>
            <th scope="col" class="py-3"><img src="{{ asset('icons/Heart_filled.svg') }}" alt="Likes"></th>
            <th scope="col" class="py-3">Title</th>
            <th scope="col" class="py-3">Content</th>
            <th scope="col" class="py-3">Categories</th>
            <th scope="col" class="py-3">
                <a
                    href="{{ path('dashboard.allBlogs', { order: order == 'ASC' ? 'DESC' : 'ASC' }) }}">
                    Created
                    {% if order == 'ASC' %}
                        <img src="{{ asset('icons/Sort From Bottom To Top.svg') }}" alt="sort icon">
                    {% else %}
                        <img src="{{ asset('icons/Sort From Top To Bottom.svg') }}" alt="sort icon">
                    {% endif %}
                </a>
            </th>
            <th scope="col" class="py-3">Status</th>
            <th scope="col" class="pe-3 py-3">Update</th>
        </tr>
        </thead>
        <tbody>
        {# {{ dump(blogs) }} #}
        {% if blogs|length > 0 %}
            {% for key,blog in blogs %}
                <tr>
                    {#   ID   #}
                    <td colspan="1" class="text-secondary ps-3 py-3 fs-7">{{ blog.id }}</td>

                    {#   Number of Likes   #}
                    <td class="py-3 fs-7">
                        <div class="d-flex align-items-center gap-1">
                            <span>{{ likesCount[blog.id] ?? 0 }}</span>
                        </div>
                    </td>

                    {#   Title   #}
                    <td class="py-3 fs-7">
                        <a href="{{ path('blog.one_blog', { id: blog.id }) }}"
                           class="link-no-underline-black d-inline-block align-items-center"
                           data-tooltip="Users"
                           data-tooltip-placement="right">
                            <img class="me-2" src="{{ asset('icons/Link Square.svg') }}" alt="pen icon">
                            {{ blog.title|u.truncate(10, '...') }}
                        </a>
                    </td>

                    {#   Content   #}
                    <td class="py-3 fs-7">{{ blog.content|u.truncate(40, '...') }}</td>

                    <td class="py-3 fs-7">New, Java, something,</td>

                    {#   Created_at   #}
                    <td class="py-3 fs-7">{{ blog.createdAt|date('Y-m-d') }}</td>

                    {#   Status   #}
                    <td class="py-3 fs-7">
                        {% if (blog.published) %}
                            <a
                                href="#"
                                data-bs-toggle="modal"
                                data-bs-target="#updateModal-{{ blog.id }}">
                                          <span class="indicator published"
                                                data-bs-toggle="tooltip"
                                                data-bs-placement="top"
                                                data-bs-title="Published"
                                          >
                                        </span>
                            </a>
                        {% else %}
                            <a
                                href="#"
                                data-bs-toggle="modal"
                                data-bs-target="#updateModal-{{ blog.id }}">
                                         <span class="indicator draft"
                                               data-bs-toggle="tooltip"
                                               data-bs-placement="top"
                                               data-bs-title="Unpublished"
                                         >
                                        </span>
                            </a>
                        {% endif %}
                    </td>

                    {#   Action buttons   #}
                    <td class="py-3">
                        {#   delete   #}
                        <a class="me-3" href="#" data-bs-toggle="modal"
                           data-bs-target="#deleteModal-{{ blog.id }}">
                            <img
                                data-bs-toggle="tooltip"
                                data-bs-placement="top"
                                data-bs-title="Delete"
                                src="{{ asset('icons/Trash Bin Trash.svg') }}"
                                alt="pen icon">
                        </a>
                        {#   edit   #}
                        <a href="{{ path('blog.edit', {id: blog.id} ) }}" data-bs-toggle="tooltip"
                           data-bs-placement="top"
                           data-bs-title="Edit">
                            <img src="{{ asset('icons/Pen New Square.svg') }}" alt="pen icon">
                        </a>
                    </td>
                </tr>

                {% include "components/_modalConfirm.html.twig" with {
                    modal_id: "deleteModal-" ~ blog.id,
                    title: "Confirm Deletion",
                    body: "Are you sure you want to delete <strong>" ~ blog.title ~ "</strong>?",
                    confirm_path: path('blog.delete', {id: blog.id}),
                    confirm_text: "Delete"
                } %}

                {% include "components/_modalConfirm.html.twig" with {
                    modal_id: "updateModal-" ~ blog.id,
                    title: "Update Status",
                    body: "Are you sure you want to update <strong>" ~ blog.title ~ "</strong>?",
                    confirm_path: path('blog.blogStatus', {id: blog.id}),
                    confirm_text: "Confirm"
                } %}

            {% endfor %}
        {% else %}
            {{ include('components/_emptyPage.html.twig' , {message : "No Blogs yet", linkText: "New Blog", linkPath: "blog.create"}) }}
        {% endif %}

        </tbody>
    </table>
</div>
