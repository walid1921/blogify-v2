<div class=" table-responsive border border-black border-opacity-25 ">
    {# {{ dump(categories) }} #}
    {% if blogCategories|length > 0 %}
        <table class="table table-striped table-hover">
            <thead class="table-light">
            <tr>
                <th scope="col" class="p-3">Category</th>
                <th scope="col" class="p-3">Created</th>
                <th scope="col" class="p-3">Update</th>
            </tr>
            </thead>
            <tbody>
            {% for key,category in blogCategories %}
                <tr>
                    {#   category name   #}
                    <td class="p-3 fs-7">
                        <div class="d-flex align-items-center gap-1">
                            <span>{{ category.name }}</span>
                        </div>
                    </td>

                    {#   category created date   #}
                    <td class="p-3 fs-7">
                        <div class="d-flex align-items-center gap-1">
                            <span>{{ category.createdAt|date('Y-m-d') }}</span>
                        </div>
                    </td>

                    {#   Action buttons   #}
                    <td class="p-3">
                        {#   delete   #}
                        <a href="#"
                           class="me-3 open-delete-category-modal delete-btn"
                           data-category-id="{{ category.id }}"
                           data-category-name="{{ category.name }}"
                        >
                            <i data-bs-toggle="tooltip"
                               data-bs-placement="top"
                               data-bs-title="Delete"
                               class="bi bi-x-circle fs-5">
                            </i>
                        </a>
                        {#   edit   #}
                        <a
                            class="edit-btn"
                            href="{{ path('dashboard.editBlogCategories', {id: category.id} ) }}"
                            data-bs-toggle="tooltip"
                            data-bs-placement="top"
                            data-bs-title="Edit">
                            <i class="bi bi-pencil-square fs-5"></i>
                        </a>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% else %}
        {{ include('components/_emptyPage.html.twig' , {message : "No Categories yet", linkText: "New Category", linkPath: "dashboard.createBlogCategories"}) }}
    {% endif %}

    {% include "components/_modalConfirm.html.twig" with {
        modal_id: "globalDeleteCategoryModal",
        title: "Confirm Deletion",
        body: "Are you sure you want to delete the category '<strong id=\"deleteCategoryName\"></strong>'?",
        confirm_path: "",
        confirm_text: "Delete"
    } %}
</div>

<script>
    document.addEventListener('click', function (e) {
        const delBtn = e.target.closest('.open-delete-category-modal');
        if (delBtn) {
            e.preventDefault();
            const categoryId = delBtn.dataset.categoryId;
            const categoryName = delBtn.dataset.categoryName;
            const modalEl = document.getElementById('globalDeleteCategoryModal');
            const form = modalEl.querySelector('#confirmActionForm');
            const categoryNameEl = modalEl.querySelector('#deleteCategoryName');

            if (form) {
                form.action = `/categories/delete/${categoryId}`;
            }
            if (categoryNameEl) {
                categoryNameEl.textContent = categoryName;
            }

            // Show the modal using Bootstrap
            if (window.bootstrap && window.bootstrap.Modal) {
                const modal = window.bootstrap.Modal.getOrCreateInstance(modalEl);
                modal.show();
            }
        }
    });
</script>
